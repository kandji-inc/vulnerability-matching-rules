# vulnerability-matching-rules
Rules for matching App Bundles to CPEs

How to update rules used in vulnerability-detection service:
1. Make a branch
2. Add a rule to /rules or a folder within /rules.
   Rule is validated from pydantic_model.py file during CI and can optionally have a description
   key which describes how the rule works.
3. Run `make lint` to make sure rule is formatted properly 
4. PR into main

For listing rules for MERC: https://vulnerability-detection-validation.dev.internal-kandji.io/merc:
   1. Run `make list-rules`. If you only wish to use a specific folders rules, run `make list-rules RULES_SUB_PATH=<path>`
      for example the rules in a folder at `rules/a` would be selected by running `make list-rules RULES_SUB_PATH=a`
   2. A file `output_rules_list.json` will be created that you can copy the content of into the MERC tool directly.

Note: Since rules need to be proper JSON, escaping characters with Regex needs to use two backslashes "\\"
