import argparse
import os
import orjson
from pydantic_model import *


def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("rules_path")
    parser.add_argument("schema_path")
    args = parser.parse_args()

    rules = []
    for location in os.listdir(args.rules_path):
        with open(f"{args.rules_path}/{location}") as f:
            rules.append(orjson.loads(f.read()))

    # check rules
    for r in rules:
        VulnerabilityMatchingRule.parse_obj(r)


if __name__ == "__main__":
    main()
